<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>工程费结算计算器</title>
  <link rel="stylesheet" href="styles.css" />
</head>

<body>
  <div class="container">
    <header>
      <h1>工程费结算计算器</h1>
      <div class="actions">
        <button id="clearBtn" class="btn btn-secondary">清空数据</button>
        <button id="exportExcelBtn" class="btn btn-success">导出Excel</button>
        <button id="exportPdfBtn" class="btn btn-danger">导出PDF</button>
      </div>
    </header>

    <div class="table-container">
      <table id="settlementTable">
        <thead>
          <tr id="headerRow">
            <th class="col-index">序号</th>
            <th class="col-name">姓名</th>

            <!-- 第1个数据列 -->
            <th class="col-data">
              <input type="text" class="header-input" placeholder="列标题" value="标题一" />
              <button class="delete-col-btn" onclick="deleteColumn(this)" style="display:none;">删除</button>
            </th>

            <!-- 等号列：作为插入锚点，必须始终存在 -->
            <th class="col-equals">=</th>

            <th class="col-total">总计</th>
          </tr>
        </thead>

        <tbody id="tableBody">
          <tr data-row-index="0">
            <td class="col-index">1</td>
            <td><input type="text" class="name-input" placeholder="姓名" /></td>
            <td><input type="number" class="data-input" placeholder="0.00" step="0.01" /></td>
            <td class="col-equals">=</td>
            <td class="total-cell">0.00</td>
          </tr>
        </tbody>

        <tfoot>
          <tr id="totalRow">
            <td class="total-label">总计</td>
            <td class="total-label">金额</td>
            <td class="column-total">0.00</td>
            <td class="col-equals">=</td>
            <td id="grandTotal" class="grand-total">0.00</td>
          </tr>
        </tfoot>
      </table>
    </div>

    <div class="controls">
      <button id="addRowBtn" class="btn btn-primary">+ 添加行</button>
      <button id="addColBtn" class="btn btn-primary">+ 添加列</button>
    </div>

    <footer>
      <p>提示：数据会自动保存到浏览器本地</p>
    </footer>
  </div>

  <!-- 引入外部库 -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.31/jspdf.plugin.autotable.min.js"></script>
  <script src="script.js"></script>
</body>
</html>
